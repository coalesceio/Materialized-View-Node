fileVersion: 1
id: "1"
macroString: |-
  {###########################################################################################
  Purpose: Determines the correct Snowflake DROP object syntax based on the materialization type.
   
  Input: materialization (string): The Snowflake object type to be dropped
    (e.g., table, view, materialized view, dynamic table, external table).
   
  Returns: string: The appropriate DROP object keyword with IF EXISTS
    (e.g., 'table IF EXISTS', 'view IF EXISTS', 'materialized view IF EXISTS').
  #############################################################################################}
  {% macro dropMaterialization(materialization) %}
      {%- if materialization | lower in ['table', 'transient table','temporary table', 'hybrid table'] -%}
          TABLE IF EXISTS
      {%- elif materialization | lower in ['view', 'secure view'] -%}
          VIEW IF EXISTS
      {%- elif materialization | lower == 'materialized view' -%}
          MATERIALIZED VIEW IF EXISTS
      {%- elif materialization | lower in ['dynamic table','transient dynamic table', 'dynamic iceberg table'] -%}
          DYNAMIC TABLE IF EXISTS
      {%- elif materialization | lower == 'external table' -%}
          EXTERNAL TABLE IF EXISTS
      {%- elif materialization | lower in ['iceberg table'] -%}
          ICEBERG TABLE IF EXISTS
      {%- else -%}
          TABLE IF EXISTS
      {%- endif %}
  {% endmacro %}
name: macro
type: Macro
